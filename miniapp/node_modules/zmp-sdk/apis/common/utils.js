import r from'./../external/@swc/helpers/src/_async_to_generator.mjs.js';import t from"../utils/query-string.js";import{APIS as e}from"../constants.js";import a from"../utils/lodash.js";import o from"../utils/request.js";import{__generator as n}from'./../external/tslib/tslib.es6.js';var s,i=(s=r((function(r,o,s){var i,d,p,c;return n(this,(function(n){switch(n.label){case 0:return i={appId:r,versionStatus:o},a.isUndefined(s)||(i.currentVersion=s),d=t.appendToUrl(e.GET_APP_INFO,i),[4,fetch(d,{credentials:"include"})];case 1:return(p=n.sent()).ok?[4,p.json()]:[3,3];case 2:if((c=n.sent()).err<0||!c.data)throw new Error(c);return[2,{name:c.data.name,version:c.data.version,description:c.data.description,appUrl:c.data.appUrl,qrCodeUrl:c.data.qrCodeUrl,logoUrl:c.data.logoUrl}];case 3:throw new Error("Can't get app info")}}))})),function(r,t,e){return s.apply(this,arguments)});function d(r){try{var t=r.map((function(r){return{action:r.action,error:r.error,message:r.message,data:r.data}}));o.execute(e.SEND_ACTION_LOG,"post",{appId:window.APP_ID,data:JSON.stringify(t)},(function(r){})),window.zmpSentry&&window.zmpSentry.captureMessage("Result from native",{extra:{data:r}})}catch(r){}}export{i as getAppInfo,d as sendLogData};
