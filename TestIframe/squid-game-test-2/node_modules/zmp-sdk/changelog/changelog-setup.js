module.exports = function (Handlebars) {
  Handlebars.registerHelper('validTag', function (tag, commits, options) {
    if (!tag || tag.indexOf('-') >=0 || commits.length <= 0) return false;
    var version = tag.split('v')[1];
    return version.localeCompare('2.21.2', undefined, { numeric: true, sensitivity: 'base' }) > 0;
  });

  Handlebars.registerHelper('commitFormat', function (options) {
    const string = options.fn(this);
    var mapObj = {
      'breaking change:': '',
      'fix:': '',
      'feat:': ''
    };
    return string.replace(/('breaking change:|fix:|feat:)(.*)/gi, function (matched, a, b) {
      const g2 = b.trim()
      return `${mapObj[a]}${g2.charAt(0).toUpperCase() + g2.slice(1)}`;
    });
  });
};
